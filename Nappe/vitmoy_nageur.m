clear all;
nombreVid=970;
dateCatalogue={'200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200128','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200129','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200130','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200204','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205','200205'};
numPassage=[1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10,1:10];
numProf={1,1,1,1,1,1,1,1,1,1,26,26,26,26,26,26,26,26,26,26,17,17,17,17,17,17,17,17,17,17,7,7,7,7,7,7,7,7,7,7,13,13,13,13,13,13,13,13,13,13,3,3,3,3,3,3,3,3,3,3,22,22,22,22,22,22,22,22,22,22,10,10,10,10,10,10,10,10,10,10,20,20,20,20,20,20,20,20,20,20,5,5,5,5,5,5,5,5,5,5,15,15,15,15,15,15,15,15,15,15,8,8,8,8,8,8,8,8,8,8,28,28,28,28,28,28,28,28,28,28,18,18,18,18,18,18,18,18,18,18,24,24,24,24,24,24,24,24,24,24,4,4,4,4,4,4,4,4,4,4,19,19,19,19,19,19,19,19,19,19,32,32,32,32,32,32,32,32,32,32,27,27,27,27,27,27,27,27,27,27,11,11,11,11,11,11,11,11,11,11,30,30,30,30,30,30,30,30,30,30,9,9,9,9,9,9,9,9,9,9,14,14,14,14,14,14,14,14,14,14,31,31,31,31,31,31,31,31,31,31,2,2,2,2,2,2,2,2,2,2,25,25,25,25,25,25,25,25,25,25,23,23,23,23,23,23,23,23,23,23,16,16,16,16,16,16,16,16,16,16,29,29,29,29,29,29,29,29,29,29,6,6,6,6,6,6,6,6,6,6,21,21,21,21,21,21,21,21,21,21,12,12,12,12,12,12,12,12,12,12,8,8,8,8,8,8,8,8,8,8,38,38,38,38,38,38,38,38,38,38,24,24,24,24,24,24,24,24,24,24,5,5,5,5,5,5,5,5,5,5,12,12,12,12,12,12,12,12,12,12,30,30,30,30,30,30,30,30,30,30,4,4,4,4,4,4,4,4,4,4,39,39,39,39,39,39,39,39,39,39,16,16,16,16,16,16,16,16,16,16,9,9,9,9,9,9,9,9,9,9,37,37,37,37,37,37,37,37,37,37,6,6,6,6,6,6,6,6,6,6,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,32,32,32,32,32,32,32,32,32,32,21,21,21,21,21,21,21,21,21,21,40,40,40,40,40,40,40,40,40,40,42,42,42,42,42,42,42,42,42,42,31,31,31,31,31,31,31,31,31,31,46,46,46,46,46,46,46,46,46,46,45,45,45,45,45,45,45,45,45,45,43,43,43,43,43,43,43,43,43,43,23,23,23,23,23,23,23,23,23,23,10,10,10,10,10,10,10,10,10,10,28,28,28,28,28,28,28,28,28,28,34,34,34,34,34,34,34,34,34,34,14,14,14,14,14,14,14,14,14,14,17,17,17,17,17,17,17,17,17,17,33,33,33,33,33,33,33,33,33,33,29,29,29,29,29,29,29,29,29,29,15,15,15,15,15,15,15,15,15,15,18,18,18,18,18,18,18,18,18,18,41,41,41,41,41,41,41,41,41,41,35,35,35,35,35,35,35,35,35,35,13,13,13,13,13,13,13,13,13,13,25,25,25,25,25,25,25,25,25,25,20,20,20,20,20,20,20,20,20,20,27,27,27,27,27,27,27,27,27,27,26,26,26,26,26,26,26,26,26,26,44,44,44,44,44,44,44,44,44,44,48,48,48,48,48,48,48,48,48,48,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,49,49,49,49,49,49,49,49,49,49,22,22,22,22,22,22,22,22,22,22,36,36,36,36,36,36,36,36,36,36,19,19,19,19,19,19,19,19,19,19,47,47,47,47,47,47,47,47,47,47,11,11,11,11,11,11,11,11,11,11,8,8,8,8,8,8,8,8,8,8,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,16,16,16,16,16,16,16,16,16,16,5,5,5,5,5,5,5,5,5,5,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,14,14,14,14,14,14,14,14,14,14,7,7,7,7,7,7,7,7,7,7,9,9,9,9,9,9,9,9,9,9,11,11,11,11,11,11,11,11,11,11,10,10,10,10,10,10,10,10,10,10,6,6,6,6,6,6,6,6,6,6,13,13,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,15,15,12,12,12,12,12,12,12,12,12,12};
nbImg=[290,200,250,200,350,300,270,350,300,350,450,300,283,350,300,500,300,500,300,300,300,280,300,550,550,380,500,400,350,300,350,300,500,300,450,400,383,600,380,650,400,550,600,300,350,450,650,300,350,350,350,400,700,400,700,700,500,350,350,450,350,400,200,200,250,250,200,400,300,250,300,500,200,350,250,275,190,300,250,550,350,300,300,350,400,300,350,580,500,300,350,300,550,400,300,650,300,600,400,650,400,500,450,400,350,750,750,750,450,600,200,250,250,150,225,175,375,225,250,300,350,300,300,400,200,300,350,200,300,350,300,350,250,300,300,250,300,300,350,350,300,350,300,300,300,300,350,350,450,400,350,250,250,250,300,300,250,350,200,250,400,200,200,400,400,450,300,400,400,500,500,300,350,400,300,450,400,350,300,600,350,350,350,400,400,450,650,300,350,350,400,400,400,400,400,450,600,375,550,550,250,300,250,300,250,300,250,250,275,300,300,350,300,350,250,350,400,350,200,300,250,300,250,250,275,300,240,350,276,300,350,250,300,300,250,300,300,280,400,250,300,400,400,400,400,350,350,350,410,500,288,250,500,350,400,250,350,400,300,450,350,550,400,500,350,400,300,300,400,450,300,250,200,275,250,300,200,300,350,250,250,300,300,200,450,400,400,350,450,350,300,300,400,350,300,300,250,350,350,300,300,300,400,400,370,300,400,450,400,500,350,400,350,400,450,450,500,400,450,600,250,250,200,200,120,350,150,200,250,200,200,200,200,300,250,250,200,250,200,250,400,200,250,250,200,200,250,250,300,250,400,200,150,250,300,500,250,250,300,300,250,200,300,300,400,350,350,300,400,250,500,300,450,250,400,250,250,400,600,250,200,150,150,150,150,150,200,150,200,200          ,200,200,150,200,200,250,250,200,200,200,400,200,250,200,160,250,230,160,300,230,200,400,200,200,200,200,200,250,150,250,100,150,100,150,200,200,200,200,150,150,200,300,150,200,150,350,200,150,150,200,200,150,150,150,200,100,100,200,100,150,300,200,250,200,200,200,200,250,300,250,200,350,250,150,150,200,400,250,300,300,    150,200,150,200,200,200,200,150,100,300,250,200,150,200,200,200,250,100,250,150,200,300,300,300,300,250,150,180,150,200,250,250,250,300,250,300,450,200,300,200,300,300,300,160,200,200,350,350,300,300,200,300,200,226,200,250,300,250,200,350,200,200,200,200,250,200,200,200,200,200,200,150,150,200,150,250,250,250,150,150,   150,250,150,150,250,300,200,250,150,300,300,300,200,200,200,200,200,300,300,200,250,200,250,350,150,200,350,150,150,200,150,150,200,200,300,200,250,200,200,250,250,250,250,250,250,250,250,250,200,350,200,250,350,200,300,300,250,300,300,350,250,300,300,300,300,160,300,200,400,300,250,450,180,250,250,400,250,250,250,400,     150,250,250,200,250,250,300,250,200,200,300,200,250,150,200,200,300,300,200,250,300,250,250,300,150,250,150,250,250,300,250,200,200,250,350,250,150,200,150,200,350,300,400,300,300,200,350,400,250,400,250,200,200,200,300,200,350,250,350,300,220,300,200,400,350,450,400,300,250,250,200,400,200,300,200,300,250,400,250,250,   350,200,150,400,300,300,300,400,350,350,200,300,250,200,300,300,250,200,250,200,150,150,250,100,150,200,150,100,200,300,150,200,150,200,100,150,150,100,350,250,300,200,200,300,150,250,250,250,200,150,300,250,450,300,200,00,250,200,300,200,150,250,250,300,200,200,350,250,300,350,300,250,250,250,150,250,300,400,350,180,200,250,300,200,420,500,450,350,250,250,450,550,400,250,400,250,250,450,250,250,     300,200,250,250,200,250,300,200,200,150,150,250,300,250,200,250,250,250,300,200,150,100,150,200,250,200,150,250,300,150,350,340,250,300,250,500,250,350,150,500,        300,250,250,250,400,250,300,300,450,200,200,200,300,500,350,200,550,350,600,400,250,250,150,120,250,200,150,250,200,150,150,250,250,400,450,300,200,350,350,250,        300,200,450,250,200,200,200,200,400,150,200,500,150,250,200,500,200,200,250,200,200,300,200,500,280,200,650,350,250,250,200,250,300,250,150,300,250,300,250,150,150,250,250,200,200,200,150,250,250,200,150,150,150,200,150,200,200,200,150,300,250,300,150,250,300,350,200,190,170,200,150,250,250,250,200,300,350,250,250,350];
nbImg(81)=310;
nbImg(766)=200;
prof=zeros(1,nombreVid);
for i=1:nombreVid
    if i<321
        prof(i)=10-(numProf{i}-1)*0.3;
    else if i>320 && i< 811
            prof(i)=15-(numProf{i}-1)*0.3;
        else if i>810
                prof(i)=5-(numProf{i}-1)*0.3;
            end
        end
    end
end

vit5=[];
vit10=[];
vit15=[];

for numVid=1:nombreVid
    numVid
    if numVid<731
        directoryVid=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\',num2str(numProf{numVid}),'\',num2str(numPassage(numVid)),'\');
        directoryPiv=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\',num2str(numProf{numVid}),'\Piv\');
        baseDir=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\',num2str(numProf{numVid}),'\');
        
        
    end
    if numVid>730 && numVid<811
        directoryVid=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\15\',num2str(numProf{numVid}),'\',num2str(numPassage(numVid)),'\');
        directoryPiv=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\15\',num2str(numProf{numVid}),'\Piv\');
        baseDir=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\15\',num2str(numProf{numVid}),'\');
        
    end
    if numVid>810
        directoryVid=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\5\',num2str(numProf{numVid}),'\',num2str(numPassage(numVid)),'\');
        directoryPiv=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\5\',num2str(numProf{numVid}),'\Piv\');
        baseDir=strcat('Y:\cgouiller\Nappe\',dateCatalogue{numVid},'\5\',num2str(numProf{numVid}),'\');
    end
    
    
    
    load(strcat(directoryVid,'alea.mat'));
    load(strcat(directoryVid,'trajectories.mat'));
    
tracks=sortrows(tracks,4);
tracks(:,2)=tracks(:,2)+200;
    
    for kk=1:length(alea) %696Juste pour être sûr que ça dépasse pas
        k=alea(kk);
        if numVid<321
            vit10=[vit10,tracks(k+2,8)];% +2 pcq on veut le instantané entre k et k+4 puisque c'est les images qu'on prend comme PIV
        else if numVid>320 && numVid< 811
                vit15=[vit15,tracks(k+2,8)];
            else if numVid>810
                    vit5=[vit5,tracks(k+2,8)];
                end
            end
        end
    end
    
    
    
end
fps=200;
vit10v=nanmean(vit10)/8.09*fps;
vit5v=nanmean(vit5)/8.09*fps;
vit15v=nanmean(vit15)/8.09*fps;


